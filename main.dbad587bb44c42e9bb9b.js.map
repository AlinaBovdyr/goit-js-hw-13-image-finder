{"version":3,"sources":["webpack:///./scripts/apiService.js","webpack:///./index.js","webpack:///./scripts/getRefs.js","webpack:///./templates/photo-card.hbs"],"names":["ImagesApiService","this","searchQuery","page","fetchImages","searchParams","URLSearchParams","q","image_type","orientation","per_page","key","fetch","BASE_URL","then","response","json","hits","resetPage","newQuery","require","defaults","delay","refs","searchForm","document","querySelector","galleryContainer","observerEl","imagesApiService","modal","basicLightbox","images","length","error","text","insertAdjacentHTML","photoCardsTpl","appendPhotoCardsMarkup","clearPhotoCardsContainer","innerHTML","onGalleryContainerClick","event","image","lightboxImg","urlOriginal","altAttribute","target","closest","show","window","addEventListener","onKeyPress","dataset","source","alt","setAttribute","close","galleryItems","Array","from","children","currentImage","find","galleryImage","firstElementChild","getAttribute","currentIndex","indexOf","lastImageNum","IntersectionObserver","entries","forEach","entry","isIntersecting","query","rootMargin","observe","e","preventDefault","currentTarget","elements","value","trim","alert","type","Handlebars","module","exports","template","container","depth0","helpers","partials","data","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","stack1","program","noop"],"mappings":"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","file":"main.dbad587bb44c42e9bb9b.js","sourcesContent":["const BASE_URL = 'https://pixabay.com/api/';\r\nconst KEY = '19151711-be14d41e7a0bdcd70a93cb54b';\r\n        \r\nexport default class ImagesApiService {\r\n    constructor() {\r\n        this.searchQuery = '';\r\n        this.page = 1;\r\n    }\r\n\r\n    fetchImages() {\r\n        const searchParams = new URLSearchParams({\r\n            q: this.searchQuery,\r\n            image_type: 'photo',\r\n            orientation: 'horizontal',\r\n            page: this.page,\r\n            per_page: 12,\r\n            key: KEY,\r\n        });\r\n\r\n        const url = `${BASE_URL}?${searchParams}`;\r\n\r\n        return fetch(url)\r\n            .then(response => response.json())\r\n            .then(({hits}) => {\r\n                this.page += 1; \r\n\r\n                return hits;\r\n            });\r\n    }\r\n\r\n    resetPage() {\r\n        this.page = 1;\r\n    }\r\n\r\n    get query() {\r\n        return this.searchQuery;\r\n    }\r\n\r\n    set query(newQuery) {\r\n        this.searchQuery = newQuery;\r\n    }\r\n}","import getRefs from './scripts/getRefs';\nimport ImagesApiService from './scripts/apiService';\nimport photoCardsTpl from './templates/photo-card.hbs';\nimport { alert, error } from '@pnotify/core';\nimport * as basicLightbox from 'basiclightbox';\n\nimport './scss/styles.scss';\nimport '@pnotify/core/dist/PNotify.css';\nimport '@pnotify/core/dist/BrightTheme.css';\nimport '../node_modules/basicLightbox/dist/basicLightbox.min.css';\n\nconst { defaults } = require('@pnotify/core');\ndefaults.delay = '1500';\n\nconst refs = getRefs();\nconst imagesApiService = new ImagesApiService();\n\nconst modal = basicLightbox.create(`\n        <div class=\"lightbox__content\">\n            <img class=\"lightbox__image\" src=\"\" alt=\"\" />\n        </div>\n`);\n\nconst observerOptions = {\n    rootMargin: '200px',\n};\n\nconst observer = new IntersectionObserver(onEntry, observerOptions);\n\nobserver.observe(refs.observerEl);\n\nrefs.searchForm.addEventListener('submit', onSearch);\n\nfunction onEntry(entries) {\n    entries.forEach(entry => {\n        if (entry.isIntersecting && imagesApiService.query !== '') {\n            fetchImages();\n        }\n    });\n};\n\nfunction onSearch(e) {\n    e.preventDefault();\n\n    imagesApiService.query = e.currentTarget.elements.query.value;\n\n    if (imagesApiService.query.trim() === '') {\n        clearPhotoCardsContainer();\n\n        return alert({\n            text: \"Please enter a Search query!\",\n            type: 'info'\n        });\n    }\n    \n    imagesApiService.resetPage();\n    clearPhotoCardsContainer();\n    fetchImages().then(() => {\n        refs.galleryContainer.addEventListener('click', onGalleryContainerClick);\n    });    \n}\n\nfunction fetchImages() {\n    return imagesApiService.fetchImages().then(images => {\n        appendPhotoCardsMarkup(images);\n    });\n}\n\nfunction appendPhotoCardsMarkup(hits) {\n    if (hits.length === 0) {\n        return error({\n            text: \"Photo not found. Please enter a more specific query!\"\n        });\n    }\n\n    refs.galleryContainer.insertAdjacentHTML('beforeend', photoCardsTpl(hits));\n}\n\nfunction clearPhotoCardsContainer() {\n    refs.galleryContainer.innerHTML = '';\n}\n\nfunction onGalleryContainerClick(event) {\n    if (event.target.closest('img')) {\n        openModal();\n        changeLightboxImgAttributes(event.target);\n    } \n}\n\nfunction openModal() {\n    modal.show();\n    window.addEventListener('keydown', onKeyPress);\n}\n\nfunction changeLightboxImgAttributes(image) {\n    const lightboxImg = document.querySelector('.lightbox__image');\n    const urlOriginal = image.dataset.source;\n    const altAttribute = image.alt;\n    lightboxImg.setAttribute('src', `${urlOriginal}`);\n    lightboxImg.setAttribute('alt', `${altAttribute}`);\n}\n\nfunction onKeyPress(event) {\n    const lightboxImg = document.querySelector('.lightbox__image');\n\n    if (event.key === 'Escape') {\n        modal.close();\n    }\n\n    const galleryItems = Array.from(refs.galleryContainer.children);\n    \n    const currentImage = galleryItems.find(galleryImage => {\n        \n        if (galleryImage.firstElementChild.dataset.source === lightboxImg.getAttribute('src')) {\n            return galleryImage\n        }\n    });\n    \n    const currentIndex = galleryItems.indexOf(currentImage);\n    const lastImageNum = galleryItems.length - 1;\n    \n    if (event.key === 'ArrowRight') {\n        if (currentIndex === lastImageNum) {\n            fetchImages();\n        }\n\n        lightboxImg.setAttribute('src', galleryItems[currentIndex + 1].firstElementChild.dataset.source);\n    } else if (event.key === 'ArrowLeft') {\n        if (currentIndex === 0) {\n            return;\n        }\n\n        lightboxImg.setAttribute('src', galleryItems[currentIndex - 1].firstElementChild.dataset.source);\n    }\n}\n\n\n","export default function getRefs() {\r\n    return {\r\n        searchForm: document.querySelector('.search-form'),\r\n        galleryContainer: document.querySelector('.gallery'),\r\n        observerEl: document.querySelector('#observer')\r\n    }\r\n}","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=container.hooks.helperMissing, alias3=\"function\", alias4=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<li class=\\\"photo-card\\\">\\r\\n    <img class=\\\"photo-card-image\\\" src=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"webformatURL\") || (depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"webformatURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":39},\"end\":{\"line\":3,\"column\":55}}}) : helper)))\n    + \"\\\" data-source=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"largeImageURL\") || (depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"largeImageURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":70},\"end\":{\"line\":3,\"column\":87}}}) : helper)))\n    + \"\\\" alt=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"tags\") || (depth0 != null ? lookupProperty(depth0,\"tags\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"tags\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":94},\"end\":{\"line\":3,\"column\":102}}}) : helper)))\n    + \"\\\" />\\r\\n\\r\\n    <div class=\\\"stats\\\">\\r\\n        <p class=\\\"stats-item\\\">\\r\\n            <i class=\\\"material-icons\\\">thumb_up</i>\\r\\n            \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"likes\") || (depth0 != null ? lookupProperty(depth0,\"likes\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"likes\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":8,\"column\":12},\"end\":{\"line\":8,\"column\":21}}}) : helper)))\n    + \"\\r\\n        </p>\\r\\n        <p class=\\\"stats-item\\\">\\r\\n            <i class=\\\"material-icons\\\">visibility</i>\\r\\n            \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"views\") || (depth0 != null ? lookupProperty(depth0,\"views\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"views\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":12,\"column\":12},\"end\":{\"line\":12,\"column\":21}}}) : helper)))\n    + \"\\r\\n        </p>\\r\\n        <p class=\\\"stats-item\\\">\\r\\n            <i class=\\\"material-icons\\\">comment</i>\\r\\n            \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"comments\") || (depth0 != null ? lookupProperty(depth0,\"comments\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"comments\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":16,\"column\":12},\"end\":{\"line\":16,\"column\":24}}}) : helper)))\n    + \"\\r\\n        </p>\\r\\n        <p class=\\\"stats-item\\\">\\r\\n            <i class=\\\"material-icons\\\">cloud_download</i>\\r\\n            \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"downloads\") || (depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"downloads\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":20,\"column\":12},\"end\":{\"line\":20,\"column\":25}}}) : helper)))\n    + \"\\r\\n        </p>\\r\\n    </div>\\r\\n</li>\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),depth0,{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":1,\"column\":0},\"end\":{\"line\":24,\"column\":9}}})) != null ? stack1 : \"\");\n},\"useData\":true});"],"sourceRoot":""}